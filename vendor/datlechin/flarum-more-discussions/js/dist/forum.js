(()=>{var t={n:o=>{var e=o&&o.__esModule?()=>o.default:()=>o;return t.d(e,{a:e}),e},d:(o,e)=>{for(var i in e)t.o(e,i)&&!t.o(o,i)&&Object.defineProperty(o,i,{enumerable:!0,get:e[i]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};(()=>{"use strict";t.r(o);const e=flarum.core.compat["forum/app"];var i=t.n(e);const s=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/components/PostStream"];var n=t.n(r);function a(t,o){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},a(t,o)}const c=flarum.core.compat["common/Component"];var u=t.n(c);const l=flarum.core.compat["forum/components/DiscussionListItem"];var d=t.n(l);const f=flarum.core.compat["common/components/LoadingIndicator"];var p=t.n(f),h=function(t){var o,e;function s(){for(var o,e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return(o=t.call.apply(t,[this].concat(i))||this).loading=!1,o.discussions=[],o.limit=0,o.blockName="",o.filterBy="",o.isRelated=!1,o}e=t,(o=s).prototype=Object.create(e.prototype),o.prototype.constructor=o,a(o,e);var r=s.prototype;return r.oninit=function(o){t.prototype.oninit.call(this,o),this.loading=!0,this.discussions=[],this.limit=i().forum.attribute("datlechin-more-discussions.discussionLimit")||5,this.filterBy=i().forum.attribute("datlechin-more-discussions.filterBy"),this.blockName=i().forum.attribute("datlechin-more-discussions.blockName")||i().translator.trans("datlechin-more-discussions.forum.block_default_name"),this.isRelated=i().forum.attribute("datlechin-more-discussions.isRelated"),this.load()},r.view=function(t){var o=this.discussions;return m("[",null,m("div",{className:"DiscussionList"},m("h2",{className:"MoreDiscussions-title"},m.trust(this.blockName)),m("ul",{role:"feed","aria-busy":this.loading,className:"DiscussionList-discussions"},this.loading?m(p(),null):o.map((function(t){return m("li",{key:t.id(),"data-id":t.id(),role:"article","aria-setsize":"-1"},m(d(),{discussion:t,params:{}}))})))))},r.load=function(){var t=this;i().store.find("discussions",{page:{limit:this.limit},sort:this.filterBy,filter:{q:this.isRelated?i().current.data.discussion.title():null}}).then((function(o){t.discussions=o,t.loading=!1,m.redraw()}))},s}(u());i().initializers.add("datlechin/flarum-more-discussions",(function(){(0,s.extend)(n().prototype,"oncreate",(function(){var t=document.querySelector(".PostStream");if(t){var o=document.createElement("div");o.classList.add("MoreDiscussions"),m.mount(function(t,o){if(o.parentNode)return o.parentNode.insertBefore(t,o.nextSibling)}(o,t),h)}}))}))})(),module.exports=o})();
//# sourceMappingURL=forum.js.map